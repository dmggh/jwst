#! /usr/bin/env pysh
#-*-python-*-

"""This script removes files from the database *only*.  That means the files
may remain lingering in the cache,  deliveries directory,  etc.
"""

usage("<file-records-to-delete>...", 1)

from crds import log
from crds_server.interactive import models

fileblob_map = models.get_fileblob_map()

for name in sys.argv[1:]:
    assert name in fileblob_map, "Unknown file found: " + repr(name)

for name in sys.argv[1:]:
    log.info("Removing FileBlob", fileblob_map[name])
    fileblob_map[name].delete()

for blob in models.AuditBlob.objects.all():
    for name in sys.argv[1:]:
    	if blob.name == name:
            log.info("Removing AuditBlob:", blob)
            blob.delete()

