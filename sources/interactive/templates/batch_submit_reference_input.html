{% extends "base.html" %}

{% block head_additions %}
    {% include "fileupload/picture_form_head_additions.html" %}
{% endblock %}

{% block contents_top %}
{% endblock %}

{% block column1 %}
    <h2>Batch Submit Reference</h2>
    {% include "select_files.html" %}        

    <form method="post" action="/batch_submit_references/" enctype="multipart/form-data"
    	  onsubmit="return validate_and_confirm(this);">  {% csrf_token %}

      <h3>Derive From Context</h3>
      {% include "select_pmap.html" %}
       <br/>
        
        <h3>Change Level: <select name='change_level' value="{{change_level}}">
                <option>SEVERE</option>
                <option>MEDIUM</option>
                <option>TRIVIAL</option>
            </select>
        </h3>

        <h3>Creator:
        <input type='text' name='creator' id='creator' size="40" value="{{creator}}">
        </h3>

      <h3>Description <textarea name="description" id="description" rows="4" cols="50">{{description}}</textarea>   
      </h3>

      <h3>Auto-Rename:  {% include "auto_rename_input.html" %}  </h3>

      <h3>Compare Old Reference:  <input type="checkbox" name="compare_old_reference" value="{{compare_old_reference}}" /></h3

      <br/>
      <br/>
      <input type="submit" value="Submit References" >
    </form>


    <script type="text/javascript">
    function validate_and_confirm(form) {
        console.log("Validating batch reference form submission.");
        if (!crds.validate_select_pmap()) {
            return false;
        }
        if ($("#description").val() == "") {
            alert("Did you add a description?");
            return false;
        }
        if ($("#creator").val() == "") {
            alert("Did you add a creator?");
            return false;
        }
        return true;
    }
    </script>

{% endblock column1 %}

{% block help %}

<p><b>Batch Submit References</b> supports uploading a list of reference
files for a single instrument and reference type,  i.e. one rmap.  After checking and 
storing the reference files,   new CRDS mapping files which refer to them
are generated.  Each reference file must certify or the entire batch will be rejected.  

{% include "select_files_help.html" %}

<p><p><b>Derive From Context</b> The name of the pipeline context which 
will be recursively updated to insert the new reference files and create a new
context which includes them.

<p><p><b>Change Level</b> The degree to which the new files are expected to 
impact science results.

<p><p><b>Creator</b> author of the contents or changes to the file,  not 
necessarily the submitter.   The submitter is known based on login information.

<p><p><b>Description</b> information about what's new in this file and what
the expected impacts are.

{% include "auto_rename_help.html" %}

<p><p><b>Compare Old Reference</b> check this to perform table comparisons
against prior versions of the submitted reference file.  The prior reference
file is located by inspecting the derivation context.  Left unchecked,  
no comparison to prior versions is performed.

{% endblock help %}
