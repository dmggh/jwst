{% extends "base.html" %}

{% block head_additions %}
    {% include "fileupload/picture_form_head_additions.html" %}
{% endblock %}

{% block head_overrides %}
    {% include "jpoll/jpoll_head_overrides.html" %}
{% endblock %}

{% block contents_top %}
{% endblock %}

{% block column1 %}
    <h2>Submit {{crds_filetype|capfirst}} Files <span class='locked_instrument'>{{locked_instrument}}</span></h2>
    {% include "select_files.html" %}        

    <form method="post" action="/submit/{{crds_filetype}}/" enctype="multipart/form-data"
        id="batch_submit_form" class="jpoll_ajax_html_form"
        onsubmit="return crds.validate_and_confirm_file_submit(this);" > {% csrf_token %}

        <input type='hidden' name='observatory' value='{{observatory}}' />
        
        {% if crds_filetype == "reference" %}
            <h3>Compare Old Reference:  <input type="checkbox" name="compare_old_reference" checked /></h3>
            <div id="comparison-context-hide">
                <h3>Comparison Context</h3>
                {% include "select_pmap.html" %}
            </div>        
            <script type="text/javascript" language="javascript">
                $("input[name='compare_old_reference']").change(function() {
                    var checkbox = $("input[name='compare_old_reference']");
                    if (checkbox.is(":checked")) {
                            $("#comparison-context-hide").show();
                    } else {
                            $("#comparison-context-hide").hide();
                    };
                });
            </script>
        {% endif %}
        
        {% if crds_filetype == "mapping" %}
            <h3>Generate Contexts:
                <input name='generate_contexts' type='checkbox' value='on' checked >
            </h3>
            <div id="derivation-context-hide">
                <h3>Derive From Context</h3>
                {% include "select_pmap.html" %}  
            </div>      
            <script type="text/javascript" language="javascript">
                $("input[name='generate_contexts']").change(function() {
                    var checkbox = $("input[name='generate_contexts']");
                    if (checkbox.is(":checked")) {
                            $("#derivation-context-hide").show();
                    } else {
                            $("#derivation-context-hide").hide();
                    };
                });
            </script>
        {% endif %}
        
        <h3>Change Level:
        <select name='change_level' value="{{change_level}}">
            <option>SEVERE</option>
            <option>MEDIUM</option>
            <option>TRIVIAL</option>
        </select>
        </h3>

        <h3>Creator:
        <input type='text' name='creator' id='creator' size="40" value="{{creator}}">
        </h3>

        <h3>Description:</h3>
        <textarea name='description' id='description' rows="4" cols="50">{{description}}</textarea>

        <h3>Auto-Rename:
        {% include "auto_rename_input.html" %}
        </h3>
        
      <p></p>
      <input type="submit" value="Submit Files">
    </form>
    
{% endblock column1 %}


{% block help %}

<p><b>Submit {{crds_filetype|capfirst}} Files</b> permanently enters files into CRDS and the 
archive.

{% include "select_files_help.html" %}

{% if crds_filetype == "reference" %}
    <p><p><b>Compare Old Reference</b> check this to perform comparisons
    against prior versions of the submitted reference files identified by the
    comparison context.  If left unchecked,  the comparison context is ignored
    and no comparison to prior versions is performed.
    
    <p><p><b>Comparison Context</b> specifies the context used to locate
    comparison references.  The submitted references are matched against references
    in this context with the same parameters for the sake of comparison.
{% endif %}

<p><p><b>Change Level</b> The degree to which the new files are expected to 
impact science results.

<p><p><b>Description</b> information about what's new in this file and what
the expected impacts are.

<p><p><b>Creator</b> author of the contents or changes to the file,  not 
necessarily the submitter.  The submitter is known based on login information.

{% include "auto_rename_help.html" %}

{% if crds_filetype == "mapping" %}
    <p><p><b>Generate Contexts</b> Automatically generate a new .pmap and .imap 
    utilizing submitted rmaps.  Ignored for submitted .pmaps or .imaps.
    <p><p><b>Derivation Context</b> Generate new .imaps and .pmaps by inserting
    the submitted .rmaps into this context to derive a new one.
{% endif %}

<p><p><b>NOTE:</b> All submitted files must pass certification before they will
be accepted by CRDS.  All references referred to by a mapping must be submitted
before the mapping will be accepted.

{% endblock help %}


