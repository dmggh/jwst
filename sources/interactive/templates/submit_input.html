{% extends "base.html" %}

{% block head_additions %}
    {% include "fileupload/picture_form_head_additions.html" %}
{% endblock %}

{% block head_overrides %}
    {% include "jpoll/jpoll_head_overrides.html" %}
{% endblock %}

{% block contents_both %}

    <h2 title="{{page_title_help}}"
       >Submit {{crds_filetype|capfirst}} Files <span class='locked_instrument'>{{locked_instrument}}</span></h2>

        {% include "select_files.html" %}        

        <form method="post" action="/submit/{{crds_filetype}}/" enctype="multipart/form-data"
            id="batch_submit_form" class="jpoll_ajax_html_form"
            onsubmit="return crds.validate_and_confirm_file_submit(this);" > {% csrf_token %}

            <input type='hidden' name='observatory' value='{{observatory}}' />
            
            <span><h3 title="Degree that new files are expected to impact science results."
                      >Change Level:</h3>
            <select style="font-size: 0.75em;" name='change_level' value="{{change_level}}">
                <option>SEVERE</option>
                <option>MODERATE</option>
                <option>TRIVIAL</option>
            </select>
            </span>

            <span><h3 title="Author of new reference files, generally not the submitter."
                     >Creator:</h3>
            <input type='text' name='creator' id='creator' size="40" value="{{creator}}">
            </span>

            <span><h3 title="Information about file changes and expected impacts, include instrument and type."
                     >Description:</h3>
            <textarea name='description' id='description' rows="4" cols="50">{{description}}</textarea>
            </span>

            {% if crds_filetype == "reference" %}
                <br/> <br/> <br/>
                <span><h3 style="display:inline;">Compare Old Reference: </h3> <input type="checkbox" name="compare_old_reference" value='checked' {{compare_old_reference}} /></span>
                <div id="comparison-context-hide">
                    <h3>Comparison Context:</h3>
                    {% include "select_pmap.html" %}
                </div>        
                <script type="text/javascript" language="javascript">
                    $("input[name='compare_old_reference']").change(function() {
                        var checkbox = $("input[name='compare_old_reference']");
                        if (checkbox.is(":checked")) {
                                $("#comparison-context-hide").show();
                        } else {
                                $("#comparison-context-hide").hide();
                        };
                    });
                </script>
            {% endif %}
            
            {% if crds_filetype == "mapping" %}
                <span><h3 title="Automatically generate new .pmap and .imap referring to new rmaps."
                         >Generate Contexts:</h3>
                    <input name='generate_contexts' type='checkbox' value='checked' {{generate_contexts}}> 
                </span>
                <div id="derivation-context-hide">
                    <h3 title="Version CRDS of rules to which new files are added."
                       >Derive From Context:</h3>
                   {% include "select_pmap.html" %}  
                </div>      
                <script type="text/javascript" language="javascript">
                    $("input[name='generate_contexts']").change(function() {
                        var checkbox = $("input[name='generate_contexts']");
                        if (checkbox.is(":checked")) {
                                $("#derivation-context-hide").show();
                        } else {
                                $("#derivation-context-hide").hide();
                        };
                    });
                </script>
            {% endif %}
            
            <br/>
            <span><h3 title="When checked, automatically rename the submitted files with CRDS generated names." 
                     style="display: inline;">Auto-Rename:</h3>
              {% include "auto_rename_input.html" %}
            </span>
            
            <br/> <br/>

          <p></p>
          <input class="btn btn-primary" type="submit" value="Submit Files">
        </form>
{% endblock contents_both %}
        
{% block help %}
{% endblock help %}


