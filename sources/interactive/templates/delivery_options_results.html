{% extends "base.html" %}

{% load stdtags %}

{% block column1 %}

    <h2>Compose Delivery</h2>

    <h3>Filters</h3>
    {% if filters %}
       <table border="1">
       <tr><th>filter</th><th>value</th></tr>
        {% for filter_name, filter_value in filters.items %}
        <tr>
            <td>{{filter_name}}</td>
            <td>{{filter_value}}</td>
        </tr>
        {% endfor %}
       </table>
    {% else %}
       <p>No filters.</p>
    {% endif %}

    <form method="post" action="/delivery_process/" enctype="multipart/form-data"> {% csrf_token %}

      <input type="hidden" name="observatory" value="{{observatory}}" />
  
      <h3>Description</h3>
      <textarea name='description' rows="4" cols="50">{{description}}</textarea>
      
      <h3>Candidates for delivery</h3>
      <table border="1">
          <tr>
              <th width="15%" align="center">delivery date</th>
              <th width="15%" align="center">name</th>
              <th width="15%" align="center">status</th>
              <th width="10%" align="center">deliverer</th>
              <th width="20%" align="center">instrument</th>
              <th width="20%" align="center">filekind</th>
              <th width="20%" align="center">opus flag</th>
              <th width="20%" align="center">deliver</th>
          </tr>
          {% for db in filtered_db %}
          <tr>
              <td align="center">{{db.delivery_date|minutes}}</td>
              <td align="center">{{db.filename|browse}}</a></td>
              <td align="center"><span class="{{db.status_class}}">{{db.status}}</span></td>
              <td align="center">{{db.deliverer_user}}</td>
              <td align="center">{{db.instrument}}</td>
              <td align="center">{{db.filekind}}</td>
              <td align="center">{{db.opus_flag}}</td>
              <td align="center"><input type="checkbox" name="deliver_{{db.filename}}"></td>
          </tr>
          {% endfor %}
      </table>
      <br/>
      <input type="submit" value="Deliver" />
      <br/>
      <br/>
      
    </form>
{% endblock column1 %}
