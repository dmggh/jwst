{% load stdtags %}

<script src="/static/select_pmap.js" type="text/javascript"></script>

{% accordion  "<span id='pmap_status'></span>" %}
<table>
   <tr>
    <td><input type="radio" name="pmap_mode" value="pmap_edit" 
                onchange='crds.select_pmap_onchange("pmap_edit");' 
	       {% if pmap_edit_checked %}
	          checked="checked"
	       {% endif %}
	       />&nbsp;Editing</td>
      <td align="right">
        <input type="hidden" name="pmap_edit" value="{{pmap_edit}}" />
        <p>{{edit_context_label|gray}}</p>
        <p style='margin-top: 0' class='tiny'>or more recent</p>
      </td>
   </tr>
   <tr>
    <td><input type="radio" name="pmap_mode" value="pmap_operational" 
                onchange='crds.select_pmap_onchange("pmap_operational");' 
	       {% if pmap_operational_checked %}
	          checked="checked"
	       {% endif %}
	       />&nbsp;Operational</td>
      <td align="right">
        <input type="hidden" name="pmap_operational" value="{{pmap_operational}}" />
        <p>{{operational_context_label|gray}}</p>
        <p style='margin-top: 0' class='tiny'>or more recent</p>
      </td>
   </tr>
  <tr>
    <td><input type="radio" name="pmap_mode" value="pmap_menu" 
               onchange='crds.select_pmap_onchange("pmap_menu");' />&nbsp;Recent</td>
      <td align="right">
        <select name="pmap_menu" style="width: 25em; height: 30px; " 
                onchange='crds.set_radio("pmap_mode","pmap_menu"); crds.validate_select_pmap(); crds.close_pmap_accordion();' >
            {% for pmap in pmaps %}
                {% if pmap.0 == pmap_menu %}
                    <option value="{{pmap.0}}" selected>{{pmap.1}}</option>
                {% else %}
                    <option value="{{pmap.0}}">{{pmap.1}}</option>
                {% endif %}
            {% endfor %}
        </select>
      </td>
  </tr>
  <tr>
    <td><input type="radio" name="pmap_mode" value="pmap_text" 
                onchange='crds.select_pmap_onchange("pmap_text");' />&nbsp;User Specified</td>
      <td align="right"><input type="text" name="pmap_text" value="{{pmap_text}}"
                               onchange='crds.select_pmap_onchange("pmap_text");' />
        <span class="hint">e.g. hst_0001.pmap</span>
      </td>
  </tr>
</table>
<br/>

<p class="gray" style="font-size: 0.7em;">The <b>editing</b> context is the
  context to which new references are typically added as part of routine
  file submissions.  Normally the editing context will track the last context
  generated by any submission.
</p>

<p class="gray" style="font-size: 0.7em;"> The <b>operational</b> context is
reported back from the pipeline to CRDS as the context currently being used for
processing.  Selecting this may be appropriate for applying limited fixes to
the context currently in OPS,  by-passing pending changes on the edit context.
</p>

<p class="gray" style="font-size: 0.7em;"> <b>*reversion?*</b> indicates that the selected context
  precedes the editing context described above. Unless multiple context
  branches are being developed, or other extenuating circumstances are
  involved, *reversion?* indicates a probable error (step backwards) and a
  context which should not be selected. Actively setting the editing context
  backward, say to facilitate branching, changes the results of future *reversion?*
  checks.
</p>

{% endaccordion %}

<div class="hidden" id="pmap_labels_json" >{{pmap_labels_json}}</div>

