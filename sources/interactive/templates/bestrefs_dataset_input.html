{% extends "base.html" %}

{% block head_overrides %}
  <script src="/static/dataset_bestrefs.js" type="text/javascript"></script>
{% endblock head_overrides %}

{% block contents_both %}

<h2>Dataset Best References</h2>

<div class="row">

<div class="col-md-8">
  <form id="raw_form" action="/bestrefs/" method="post" enctype="multipart/form-data"
        onsubmit="return validate(event);"> {% csrf_token %}
    
    <h3>Context:</h3>
    {% include "select_pmap.html" %}
    
    <h3>Dataset:</h3>
    <table>
      <tr>
        <td class="h4">
            <input type="radio" name="dataset_mode" value="dataset_local" checked="checked" />Upload FITS Header
        </td>
        <td>
          {# see also set_radio_clear_fits() above #}
          <input type="file" id="dataset_local_file" onchange="crds.set_header_contents(this);" />
          <input type="text" name="dataset_name" id="dataset_name"
                 style="border:none; background:none; color:gray;"
                 >{{dataset_name}}</input>
        </td>
      </tr>
      <tr>
        <td></td>
        <td>
          <textarea name="dataset_local" id="dataset_local_textarea" rows="5" cols="40">{{dataset_local}}</textarea>
      </tr>
      {% if is_authenticated %}
      <tr>
        <td class="h4">
           <input type="radio" name="dataset_mode" value="dataset_uploaded">Upload Dataset</input>
        </td>
        <td align="left" id="dataset_uploaded_input_td">
           <input type="file" class="multi" maxlength="1" name="dataset_uploaded"
                    id="dataset_uploaded" onchange="crds.set_radio_clear_fits('dataset_uploaded');" />
        </td> 
      </tr>
      {% endif %}
      <tr>
        <td class="h4">
            <input type="radio" name="dataset_mode" value="dataset_archive" />Dataset ID
        </td>
        <td align="left">
          <input type="text" size="50" name="dataset_archive"
                 id="dataset_archive"
                 class="black"
                 value="{{dataset_archive}}" 
                 onchange="crds.set_radio_clear_fits('dataset_archive');" />
          {% if observatory == "jwst" %}
            <p class="hint">e.g. ASSOCIATION:jw00001001001_01101_01333.MIRIMAGE</p>
          {% else %}
            <p class="hint">.e.g. I9ZF01010</p>
          {% endif %}
        </td>
      </tr>
    </table>
    
    <br/>
    <input class="btn btn-primary" type="submit" value="Submit" />
    
  </form>
</div>
<div class="col-md-4">
    <div class="panel">
        <div class="panel-body">
            <p><b>Dataset Best References</b> determines the best reference files 
            for an uploaded or cataloged dataset header.
            </p>

            <p/><p><b>Context</b> defines the version of rules that should be used to determine 
            best references.
            </p>

            <p/><p><b>Upload FITS Header</b> loads reference matching parameters from a FITS file on your local system;   
            the loaded matching parameters may be edited in the browser.    
            </p>

            <p/><p><b>Dataset ID</b> specifies the id of a cataloged parameter set for which to determine best references.  
            If the dataset id names an association,  the results returned are from a
            single undefined member.  Use a specific member id for more specific results.
            </p>
        </div>
    </div>
</div>
</div>
{% endblock contents_both %}

{% block help %}
{% comment %}
    <p><b>Dataset Best References</b> determines the best reference files 
    for an uploaded or cataloged dataset header.
    </p>

    <p/><p><b>Context</b> defines the version of rules that should be used to determine 
    best references.
    </p>

    <p/><p><b>Upload FITS Header</b> loads reference matching parameters from a FITS file on your local system;   
    the loaded matching parameters may be edited in the browser.    
    </p>

    <p/><p><b>Dataset ID</b> specifies the id of a cataloged parameter set for which to determine best references.  
    If the dataset id names an association,  the results returned are from a
    single undefined member.  Use a specific member id for more specific results.
    </p>
{% endcomment %}

{% endblock help %}

{% block bottom_help %}
    {% include "bestrefs_bottom_help.html" %}
{% endblock bottom_help %}

